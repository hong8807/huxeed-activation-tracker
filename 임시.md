# HUXEED V-track ë¡œê·¸ì¸ & ê´€ë¦¬ì ì‹œìŠ¤í…œ ê°€ì´ë“œ

**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-11-07
**ë²„ì „**: v1.0 - ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ë° ê´€ë¦¬ì ì„¤ì • í˜ì´ì§€ êµ¬í˜„ ì™„ë£Œ

---

## ğŸ“‹ ëª©ì°¨

1. [ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ê°œìš”](#ë¡œê·¸ì¸-ì‹œìŠ¤í…œ-ê°œìš”)
2. [ê³µìš© ê³„ì • ë¹„ë°€ë²ˆí˜¸ ì„¤ì •](#ê³µìš©-ê³„ì •-ë¹„ë°€ë²ˆí˜¸-ì„¤ì •)
3. [ê´€ë¦¬ì ì„¤ì • í˜ì´ì§€](#ê´€ë¦¬ì-ì„¤ì •-í˜ì´ì§€)
4. [API ì—”ë“œí¬ì¸íŠ¸](#api-ì—”ë“œí¬ì¸íŠ¸)
5. [í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ](#í…ŒìŠ¤íŠ¸-ê°€ì´ë“œ)
6. [í–¥í›„ êµ¬í˜„ ê³„íš](#í–¥í›„-êµ¬í˜„-ê³„íš)

---

## ğŸ” ë¡œê·¸ì¸ ì‹œìŠ¤í…œ ê°œìš”

### 2ê°€ì§€ ê³„ì • ìœ í˜•

#### 1. ê´€ë¦¬ì ê³„ì • (Admin)
- **ì´ë©”ì¼**: `admin@example.com` (ë˜ëŠ” ì„¤ì •ëœ ê´€ë¦¬ì ì´ë©”ì¼)
- **ê¶Œí•œ**:
  - âœ… ëª¨ë“  ëŒ€ì‹œë³´ë“œ ê¸°ëŠ¥ ì ‘ê·¼
  - âœ… ê´€ë¦¬ì ì„¤ì • í˜ì´ì§€ ì ‘ê·¼
  - âœ… ê³µìš© ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
  - âœ… ë©”ì¼ ìˆ˜ì‹ ì ê´€ë¦¬
- **ì ‘ì†ìëª…**: ì´ë©”ì¼ @ ì•ë¶€ë¶„ ë˜ëŠ” ì„¤ì •ëœ ì´ë¦„

#### 2. ê³µìš© ê³„ì • (Shared)
- **ì´ë©”ì¼**: `huxeed@huxeed.com` (ê³ ì •)
- **ë¹„ë°€ë²ˆí˜¸**: ì£¼ê¸°ì ìœ¼ë¡œ ë³€ê²½ (ê´€ë¦¬ìê°€ ì„¤ì •)
- **ê¶Œí•œ**:
  - âœ… ëŒ€ì‹œë³´ë“œ, Pipeline, Reports ì ‘ê·¼
  - âŒ ê´€ë¦¬ì ì„¤ì • í˜ì´ì§€ ì ‘ê·¼ ë¶ˆê°€
- **ì ‘ì†ìëª…**: ë¡œê·¸ì¸ ì‹œ ì‹¤ëª… ì…ë ¥ í•„ìš”

### ë¡œê·¸ì¸ í”„ë¡œì„¸ìŠ¤

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  http://localhost:3000/login                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  ì´ë©”ì¼ & ë¹„ë°€ë²ˆí˜¸ ì…ë ¥  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  /api/auth/login      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â†“                       â†“
    ê´€ë¦¬ì ê³„ì •              ê³µìš© ê³„ì •
         â†“                       â†“
    Dashboard             ì ‘ì†ìëª… ì…ë ¥ ëª¨ë‹¬
                                 â†“
                         /api/auth/set-accessor
                                 â†“
                            Dashboard
```

### ì„¸ì…˜ ê´€ë¦¬

- **ë°©ì‹**: ì¿ í‚¤ ê¸°ë°˜ ì„¸ì…˜
- **ì €ì¥ ì •ë³´**:
  ```json
  {
    "email": "huxeed@huxeed.com",
    "role": "shared",
    "accessorName": "í™ê¸¸ë™"
  }
  ```
- **ì„¸ì…˜ í™•ì¸**: `/api/auth/session` (GET)
- **ë¡œê·¸ì•„ì›ƒ**: `/api/auth/logout` (POST)

### ì‚¬ì´ë“œë°” ë¡œê·¸ì¸ ì •ë³´ í‘œì‹œ

**ê³µìš© ê³„ì •**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  H  í™ê¸¸ë™               â”‚
â”‚     huxeed@huxeed.com   â”‚
â”‚     ê³µìš© ê³„ì •            â”‚
â”‚  [Logout]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ê´€ë¦¬ì ê³„ì •**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  A  admin               â”‚
â”‚     admin@example.com   â”‚
â”‚  [Logout]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ ê³µìš© ê³„ì • ë¹„ë°€ë²ˆí˜¸ ì„¤ì •

### ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ìƒì„± (ìŠ¤í¬ë¦½íŠ¸)

**í˜„ì¬ ì„¤ì •ëœ ë¹„ë°€ë²ˆí˜¸**: `Huxeed2025!`

#### 1. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

```bash
cd C:/projects/strategy2025/huxeed-activation-tracker
node scripts/generate-shared-password.js
```

#### 2. ì¶œë ¥ ì˜ˆì‹œ

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“§ ê³µìš© ê³„ì • ì„ì‹œ ë¹„ë°€ë²ˆí˜¸ ìƒì„±
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… ì´ë©”ì¼: huxeed@huxeed.com
âœ… ì„ì‹œ ë¹„ë°€ë²ˆí˜¸: Huxeed2025!

ğŸ”’ bcrypt í•´ì‹œ: $2b$10$z60VVhORWfP/z9MvXwHdu.yALZeOilnHpecPaaM7ntVGb74eXIP7y
```

#### 3. Supabase SQL ì‹¤í–‰

```sql
UPDATE users
SET password_hash = '$2b$10$z60VVhORWfP/z9MvXwHdu.yALZeOilnHpecPaaM7ntVGb74eXIP7y',
    updated_at = now()
WHERE email = 'huxeed@huxeed.com' AND role = 'shared';
```

**ì‹¤í–‰ ë°©ë²•**:
1. Supabase ëŒ€ì‹œë³´ë“œ â†’ SQL Editor
2. ìœ„ SQL ë³µì‚¬ & ë¶™ì—¬ë„£ê¸° (```sql ì œì™¸)
3. Run ë²„íŠ¼ í´ë¦­
4. ì„±ê³µ ë©”ì‹œì§€ í™•ì¸

### ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ (ê´€ë¦¬ì UI)

**ê´€ë¦¬ì ì„¤ì • í˜ì´ì§€ì—ì„œ ë³€ê²½** (ê¶Œì¥):
1. ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
2. ì‚¬ì´ë“œë°” â†’ "Admin Settings" í´ë¦­
3. "ê³µìš© ê³„ì • ë¹„ë°€ë²ˆí˜¸" íƒ­
4. ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ & í™•ì¸
5. "ë¹„ë°€ë²ˆí˜¸ ë³€ê²½" ë²„íŠ¼ í´ë¦­

**ìë™ ì²˜ë¦¬**:
- âœ… bcrypt í•´ì‹œ ìƒì„±
- âœ… users í…Œì´ë¸” ì—…ë°ì´íŠ¸
- âœ… password_history ì´ë ¥ ê¸°ë¡
- â³ ë©”ì¼ ë°œì†¡ (í–¥í›„ êµ¬í˜„)

---

## âš™ï¸ ê´€ë¦¬ì ì„¤ì • í˜ì´ì§€

### ì ‘ê·¼ ë°©ë²•

**URL**: `http://localhost:3000/admin/settings`

**ì ‘ê·¼ ê¶Œí•œ**: ê´€ë¦¬ì ê³„ì •ë§Œ ì ‘ê·¼ ê°€ëŠ¥
- ê³µìš© ê³„ì •ìœ¼ë¡œëŠ” ì‚¬ì´ë“œë°”ì— ë©”ë‰´ í‘œì‹œë˜ì§€ ì•ŠìŒ
- ì§ì ‘ URL ì ‘ê·¼ ì‹œ 403 Forbidden

### ê¸°ëŠ¥ 1: ê³µìš© ê³„ì • ë¹„ë°€ë²ˆí˜¸ ë³€ê²½

**íƒ­**: "ê³µìš© ê³„ì • ë¹„ë°€ë²ˆí˜¸"

**ì…ë ¥ í•„ë“œ**:
- ìƒˆ ë¹„ë°€ë²ˆí˜¸ (ìµœì†Œ 8ì)
- ë¹„ë°€ë²ˆí˜¸ í™•ì¸

**ìœ íš¨ì„± ê²€ì¦**:
- âŒ ë¹„ë°€ë²ˆí˜¸ 8ì ë¯¸ë§Œ â†’ ì—ëŸ¬
- âŒ ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜ â†’ ì—ëŸ¬
- âœ… ëª¨ë‘ í†µê³¼ â†’ ë³€ê²½ ì„±ê³µ

**ì²˜ë¦¬ ê³¼ì •**:
1. í´ë¼ì´ì–¸íŠ¸ì—ì„œ bcrypt í•´ì‹œ ìƒì„± (bcryptjs)
2. POST `/api/admin/update-shared-password`
3. POST `/api/admin/password-history`
4. ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ

**ì„±ê³µ ë©”ì‹œì§€**:
```
âœ… ê³µìš© ê³„ì • ë¹„ë°€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤
```

### ê¸°ëŠ¥ 2: ë©”ì¼ ìˆ˜ì‹ ì ê´€ë¦¬

**íƒ­**: "ë©”ì¼ ìˆ˜ì‹ ì ê´€ë¦¬"

**ê¸°ëŠ¥**:
- âœ… ìˆ˜ì‹ ì ëª©ë¡ ì¡°íšŒ
- âœ… ìƒˆ ìˆ˜ì‹ ì ì¶”ê°€
- âœ… ìˆ˜ì‹ ì ì‚­ì œ
- â³ ìˆ˜ì‹ ì í™œì„±í™”/ë¹„í™œì„±í™” (í–¥í›„)

**ìˆ˜ì‹ ì ì¶”ê°€ í¼**:
- ì´ë©”ì¼ ì£¼ì†Œ (í•„ìˆ˜)
- ì´ë¦„ (ì„ íƒ)
- "ì¶”ê°€" ë²„íŠ¼

**ìˆ˜ì‹ ì ëª©ë¡ í‘œì‹œ**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  user1@company.com                       â”‚
â”‚  í™ê¸¸ë™                                   â”‚
â”‚  [í™œì„±]  [ì‚­ì œ]                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  user2@company.com                       â”‚
â”‚  ê¹€ì² ìˆ˜                                   â”‚
â”‚  [í™œì„±]  [ì‚­ì œ]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒ API ì—”ë“œí¬ì¸íŠ¸

### ì¸ì¦ API

| Method | Endpoint | ì„¤ëª… | ê¶Œí•œ |
|--------|----------|------|------|
| POST | `/api/auth/login` | ë¡œê·¸ì¸ (ì´ë©”ì¼ + ë¹„ë°€ë²ˆí˜¸) | Public |
| POST | `/api/auth/set-accessor` | ê³µìš© ê³„ì • ì ‘ì†ìëª… ì„¤ì • | Authenticated |
| GET | `/api/auth/session` | í˜„ì¬ ì„¸ì…˜ ì •ë³´ ì¡°íšŒ | Authenticated |
| POST | `/api/auth/logout` | ë¡œê·¸ì•„ì›ƒ | Authenticated |

### ê´€ë¦¬ì API âœ¨ NEW

| Method | Endpoint | ì„¤ëª… | ê¶Œí•œ |
|--------|----------|------|------|
| POST | `/api/admin/update-shared-password` | ê³µìš© ë¹„ë°€ë²ˆí˜¸ ì—…ë°ì´íŠ¸ | Admin |
| POST | `/api/admin/password-history` | ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì´ë ¥ ê¸°ë¡ | Admin |
| GET | `/api/admin/email-subscribers` | ë©”ì¼ ìˆ˜ì‹ ì ëª©ë¡ ì¡°íšŒ | Admin |
| POST | `/api/admin/email-subscribers` | ë©”ì¼ ìˆ˜ì‹ ì ì¶”ê°€ | Admin |
| DELETE | `/api/admin/email-subscribers/[id]` | ë©”ì¼ ìˆ˜ì‹ ì ì‚­ì œ | Admin |

### API ì‘ë‹µ ì˜ˆì‹œ

**ì„¸ì…˜ ì¡°íšŒ (`GET /api/auth/session`)**:
```json
{
  "success": true,
  "email": "huxeed@huxeed.com",
  "role": "shared",
  "accessorName": "í™ê¸¸ë™"
}
```

**ë©”ì¼ ìˆ˜ì‹ ì ëª©ë¡ (`GET /api/admin/email-subscribers`)**:
```json
{
  "success": true,
  "subscribers": [
    {
      "id": "uuid-1234",
      "email": "user1@company.com",
      "name": "í™ê¸¸ë™",
      "is_active": true,
      "subscribed_at": "2025-11-07T00:00:00Z"
    }
  ]
}
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ

### 1. ê³µìš© ê³„ì • ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸

**Step 1**: http://localhost:3000/login ì ‘ì†

**Step 2**: ê³µìš© ê³„ì • ì •ë³´ ì…ë ¥
- ì´ë©”ì¼: `huxeed@huxeed.com`
- ë¹„ë°€ë²ˆí˜¸: `Huxeed2025!`

**Step 3**: "ë¡œê·¸ì¸" ë²„íŠ¼ í´ë¦­

**Step 4**: ì ‘ì†ìëª… ì…ë ¥ ëª¨ë‹¬
- ì‹¤ëª… ì…ë ¥: `í™ê¸¸ë™`
- "í™•ì¸" ë²„íŠ¼ í´ë¦­

**Step 5**: Dashboard í™•ì¸
- ì‚¬ì´ë“œë°” í•˜ë‹¨ì— "í™ê¸¸ë™" í‘œì‹œ
- "ê³µìš© ê³„ì •" ë¼ë²¨ í™•ì¸

### 2. ê´€ë¦¬ì ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸

**Step 1**: ê³µìš© ê³„ì • ë¡œê·¸ì•„ì›ƒ

**Step 2**: ê´€ë¦¬ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
- ì´ë©”ì¼: `admin@example.com` (ì„¤ì •ëœ ê³„ì •)
- ë¹„ë°€ë²ˆí˜¸: ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸

**Step 3**: ì‚¬ì´ë“œë°” í™•ì¸
- í•˜ë‹¨ì— "Admin Settings" ë©”ë‰´ í‘œì‹œ
- êµ¬ë¶„ì„ ìœ¼ë¡œ ì¼ë°˜ ë©”ë‰´ì™€ ë¶„ë¦¬

### 3. ê´€ë¦¬ì ì„¤ì • í˜ì´ì§€ í…ŒìŠ¤íŠ¸

**Step 1**: "Admin Settings" ë©”ë‰´ í´ë¦­

**Step 2**: ê³µìš© ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
- "ê³µìš© ê³„ì • ë¹„ë°€ë²ˆí˜¸" íƒ­ ì„ íƒ
- ìƒˆ ë¹„ë°€ë²ˆí˜¸: `NewPassword2025!`
- ë¹„ë°€ë²ˆí˜¸ í™•ì¸: `NewPassword2025!`
- "ë¹„ë°€ë²ˆí˜¸ ë³€ê²½" ë²„íŠ¼ í´ë¦­
- ì„±ê³µ ë©”ì‹œì§€ í™•ì¸

**Step 3**: ë¡œê·¸ì•„ì›ƒ í›„ ìƒˆ ë¹„ë°€ë²ˆí˜¸ í…ŒìŠ¤íŠ¸
- ê³µìš© ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
- ìƒˆ ë¹„ë°€ë²ˆí˜¸: `NewPassword2025!`
- ë¡œê·¸ì¸ ì„±ê³µ í™•ì¸

**Step 4**: ë©”ì¼ ìˆ˜ì‹ ì ê´€ë¦¬
- "ë©”ì¼ ìˆ˜ì‹ ì ê´€ë¦¬" íƒ­ ì„ íƒ
- ìƒˆ ìˆ˜ì‹ ì ì¶”ê°€:
  - ì´ë©”ì¼: `user1@company.com`
  - ì´ë¦„: `í™ê¸¸ë™`
  - "ì¶”ê°€" ë²„íŠ¼ í´ë¦­
- ëª©ë¡ì— ì¶”ê°€ëœ ìˆ˜ì‹ ì í™•ì¸
- ì‚­ì œ ì•„ì´ì½˜ í´ë¦­í•˜ì—¬ ì‚­ì œ í…ŒìŠ¤íŠ¸

### 4. ë™ì‹œ ì ‘ì† í…ŒìŠ¤íŠ¸

**Step 1**: ë¸Œë¼ìš°ì € A (Chrome)
- ê³µìš© ê³„ì • ë¡œê·¸ì¸
- ì ‘ì†ìëª…: `í™ê¸¸ë™`

**Step 2**: ë¸Œë¼ìš°ì € B (Edge or Incognito)
- ê³µìš© ê³„ì • ë¡œê·¸ì¸
- ì ‘ì†ìëª…: `ê¹€ì² ìˆ˜`

**Step 3**: ë‘ ë¸Œë¼ìš°ì € ëª¨ë‘ ì •ìƒ ì‘ë™ í™•ì¸
- ê°ì ë…ë¦½ì ì¸ ì„¸ì…˜
- ì‚¬ì´ë“œë°”ì— ê°ì ì´ë¦„ í‘œì‹œ

---

## ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”

### users í…Œì´ë¸”

```sql
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email TEXT UNIQUE NOT NULL,
  password_hash TEXT NOT NULL,
  role TEXT NOT NULL CHECK (role IN ('admin', 'shared')),
  is_active BOOLEAN DEFAULT true,
  last_login_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT now(),
  updated_at TIMESTAMP DEFAULT now()
);
```

### password_history í…Œì´ë¸”

```sql
CREATE TABLE password_history (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_email TEXT NOT NULL REFERENCES users(email) ON DELETE CASCADE,
  password_hash TEXT NOT NULL,
  changed_at TIMESTAMP DEFAULT now(),
  changed_by TEXT,
  is_notified BOOLEAN DEFAULT false,
  created_at TIMESTAMP DEFAULT now()
);
```

### email_subscribers í…Œì´ë¸”

```sql
CREATE TABLE email_subscribers (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email TEXT UNIQUE NOT NULL,
  name TEXT,
  is_active BOOLEAN DEFAULT true,
  subscribed_at TIMESTAMP DEFAULT now(),
  created_at TIMESTAMP DEFAULT now(),
  updated_at TIMESTAMP DEFAULT now()
);
```

### access_logs í…Œì´ë¸” (í–¥í›„ í™œìš©)

```sql
CREATE TABLE access_logs (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_email TEXT NOT NULL REFERENCES users(email) ON DELETE CASCADE,
  accessor_name TEXT NOT NULL,
  login_time TIMESTAMP DEFAULT now(),
  logout_time TIMESTAMP,
  ip_address TEXT,
  user_agent TEXT,
  activity_count INTEGER DEFAULT 0,
  last_activity_at TIMESTAMP DEFAULT now(),
  session_duration_seconds INTEGER,
  created_at TIMESTAMP DEFAULT now()
);
```

---

## ğŸš€ í–¥í›„ êµ¬í˜„ ê³„íš

### Phase 2: ë©”ì¼ ë°œì†¡ ê¸°ëŠ¥ â³

**ëª©í‘œ**: ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹œ ìë™ìœ¼ë¡œ ë©”ì¼ ë°œì†¡

**API ì—”ë“œí¬ì¸íŠ¸**: `POST /api/admin/send-password-email`

**ê¸°ëŠ¥**:
1. email_subscribers í…Œì´ë¸”ì—ì„œ is_active = trueì¸ ì‚¬ìš©ì ì¡°íšŒ
2. Resend APIë¥¼ í†µí•´ ë©”ì¼ ë°œì†¡
3. ë©”ì¼ í…œí”Œë¦¿:
   ```
   ì œëª©: [HUXEED] ê³µìš© ê³„ì • ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì•ˆë‚´

   ì•ˆë…•í•˜ì„¸ìš”,

   HUXEED V-track ì‹œìŠ¤í…œì˜ ê³µìš© ê³„ì • ë¹„ë°€ë²ˆí˜¸ê°€ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.

   âœ… ì´ë©”ì¼: huxeed@huxeed.com
   âœ… ìƒˆ ë¹„ë°€ë²ˆí˜¸: NewPassword2025!
   âœ… ìœ íš¨ê¸°ê°„: 1ì£¼ì¼ (2025-11-14ê¹Œì§€)

   ë¡œê·¸ì¸ í˜ì´ì§€: https://your-app.com/login

   ê°ì‚¬í•©ë‹ˆë‹¤.
   ```
4. password_historyì˜ is_notified = trueë¡œ ì—…ë°ì´íŠ¸

**í•„ìš” ë¼ì´ë¸ŒëŸ¬ë¦¬**:
```bash
npm install resend
```

**í™˜ê²½ ë³€ìˆ˜**:
```env
RESEND_API_KEY=re_xxxxxxxxxxxx
```

### Phase 3: ì£¼ê°„ ìë™ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ â³

**ëª©í‘œ**: ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤ì „ 9ì‹œì— ìë™ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½

**ë°©ì‹ 1**: Supabase Edge Function
```typescript
// supabase/functions/weekly-password-change/index.ts

import { serve } from 'https://deno.land/std@0.168.0/http/server.ts'
import { createClient } from '@supabase/supabase-js'
import bcrypt from 'bcryptjs'

serve(async (req) => {
  // 1. ëœë¤ ë¹„ë°€ë²ˆí˜¸ ìƒì„± (12ì, ëŒ€ì†Œë¬¸ì+ìˆ«ì+íŠ¹ìˆ˜ë¬¸ì)
  const newPassword = generateRandomPassword()

  // 2. bcrypt í•´ì‹œ ìƒì„±
  const hash = await bcrypt.hash(newPassword, 10)

  // 3. users í…Œì´ë¸” ì—…ë°ì´íŠ¸
  await supabase
    .from('users')
    .update({ password_hash: hash })
    .eq('email', 'huxeed@huxeed.com')

  // 4. password_history ê¸°ë¡
  await supabase.from('password_history').insert({
    user_email: 'huxeed@huxeed.com',
    password_hash: hash,
    changed_by: 'system_auto',
  })

  // 5. ë©”ì¼ ë°œì†¡
  await sendPasswordEmail(newPassword)

  return new Response('Password changed successfully')
})
```

**Cron ì„¤ì •**:
```sql
-- Supabase Dashboard â†’ Database â†’ Cron Jobs
SELECT cron.schedule(
  'weekly-password-change',
  '0 9 * * 1',  -- ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤ì „ 9ì‹œ
  $$
  SELECT net.http_post(
    url := 'https://your-project.supabase.co/functions/v1/weekly-password-change',
    headers := '{"Authorization": "Bearer YOUR_ANON_KEY"}'
  );
  $$
);
```

**ë°©ì‹ 2**: ì™¸ë¶€ Cron Job (GitHub Actions, AWS Lambda ë“±)

### Phase 4: ì ‘ì† ë¡œê·¸ ìë™ ê¸°ë¡ â³

**ëª©í‘œ**: ëª¨ë“  ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ìë™ ê¸°ë¡

**ê¸°ëŠ¥**:
- ë¡œê·¸ì¸ ì‹œ access_logsì— ë ˆì½”ë“œ ìƒì„±
- í™œë™ ì¶”ì  (í˜ì´ì§€ ì´ë™, í´ë¦­ ë“±)
- ë¡œê·¸ì•„ì›ƒ ì‹œ ì„¸ì…˜ ì¢…ë£Œ ì‹œê°„ ë° ì§€ì† ì‹œê°„ ê¸°ë¡

**ëŒ€ì‹œë³´ë“œ**:
- ì ‘ì† ì´ë ¥ ì¡°íšŒ
- ì‚¬ìš©ìë³„ í™œë™ í†µê³„
- ì‹œê°„ëŒ€ë³„ ì ‘ì† í˜„í™©

---

## ğŸ”’ ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### í˜„ì¬ êµ¬í˜„ âœ…

- bcrypt í•´ì‹œ ì‚¬ìš© (salt rounds: 10)
- ë¹„ë°€ë²ˆí˜¸ í‰ë¬¸ ì €ì¥ ê¸ˆì§€
- password_history ë³€ê²½ ì´ë ¥ ê¸°ë¡
- ê´€ë¦¬ì ê¶Œí•œ ê²€ì¦ (403 Forbidden)
- ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦

### í–¥í›„ ë³´ì•ˆ ê°•í™” â³

- **ë¹„ë°€ë²ˆí˜¸ ë³µì¡ë„ ê²€ì¦**
  - ìµœì†Œ 8ì ì´ìƒ
  - ëŒ€ë¬¸ì, ì†Œë¬¸ì, ìˆ«ì, íŠ¹ìˆ˜ë¬¸ì í¬í•¨

- **ë¹„ë°€ë²ˆí˜¸ ìœ íš¨ê¸°ê°„**
  - 1ì£¼ì¼ ìë™ ë§Œë£Œ
  - ë§Œë£Œ ì „ ì•Œë¦¼ ë©”ì¼

- **ë¡œê·¸ì¸ ì‹¤íŒ¨ ì œí•œ**
  - 5íšŒ ì‹¤íŒ¨ ì‹œ ê³„ì • ì ê¸ˆ
  - 15ë¶„ í›„ ìë™ í•´ì œ

- **IP ê¸°ë°˜ ì ‘ê·¼ ì œì–´**
  - í—ˆìš©ëœ IP ëŒ€ì—­ë§Œ ì ‘ê·¼
  - ë¹„ì •ìƒ ì ‘ê·¼ ì°¨ë‹¨

- **2ë‹¨ê³„ ì¸ì¦ (2FA)**
  - OTP ë˜ëŠ” ì´ë©”ì¼ ì¸ì¦
  - ê´€ë¦¬ì ê³„ì • í•„ìˆ˜ ì ìš©

---

## ğŸ“ ê´€ë ¨ íŒŒì¼

### í˜ì´ì§€
- `app/login/page.tsx` - ë¡œê·¸ì¸ í˜ì´ì§€
- `app/admin/settings/page.tsx` - ê´€ë¦¬ì ì„¤ì • í˜ì´ì§€

### ì»´í¬ë„ŒíŠ¸
- `components/layout/Sidebar.tsx` - ì‚¬ì´ë“œë°” (ë¡œê·¸ì¸ ì •ë³´ í‘œì‹œ)
- `components/auth/AccessorNameModal.tsx` - ì ‘ì†ìëª… ì…ë ¥ ëª¨ë‹¬
- `components/auth/AuthProvider.tsx` - ì¸ì¦ í”„ë¡œë°”ì´ë”

### API
- `app/api/auth/login/route.ts` - ë¡œê·¸ì¸
- `app/api/auth/set-accessor/route.ts` - ì ‘ì†ìëª… ì„¤ì •
- `app/api/auth/session/route.ts` - ì„¸ì…˜ ì¡°íšŒ
- `app/api/auth/logout/route.ts` - ë¡œê·¸ì•„ì›ƒ
- `app/api/admin/update-shared-password/route.ts` - ê³µìš© ë¹„ë°€ë²ˆí˜¸ ì—…ë°ì´íŠ¸
- `app/api/admin/password-history/route.ts` - ë¹„ë°€ë²ˆí˜¸ ì´ë ¥ ê¸°ë¡
- `app/api/admin/email-subscribers/route.ts` - ë©”ì¼ ìˆ˜ì‹ ì ê´€ë¦¬
- `app/api/admin/email-subscribers/[id]/route.ts` - ë©”ì¼ ìˆ˜ì‹ ì ì‚­ì œ

### ìŠ¤í¬ë¦½íŠ¸
- `scripts/generate-shared-password.js` - ë¹„ë°€ë²ˆí˜¸ í•´ì‹œ ìƒì„±

### Hooks
- `hooks/useAuth.ts` - ì¸ì¦ Hook

---

## ğŸ¯ ìš”ì•½

### âœ… êµ¬í˜„ ì™„ë£Œ

1. **ë¡œê·¸ì¸ ì‹œìŠ¤í…œ**
   - ê´€ë¦¬ì / ê³µìš© ê³„ì • ë¶„ë¦¬
   - ê³µìš© ê³„ì • ì ‘ì†ìëª… ì…ë ¥
   - ì„¸ì…˜ ê¸°ë°˜ ì¸ì¦
   - ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥

2. **ì‚¬ì´ë“œë°” ë¡œê·¸ì¸ ì •ë³´ í‘œì‹œ**
   - ì‹¤ì‹œê°„ ì„¸ì…˜ ì •ë³´ ì¡°íšŒ
   - ì—­í• ë³„ í‘œì‹œ (ê³µìš© ê³„ì • ë¼ë²¨)
   - ë¡œë”© ìƒíƒœ ì²˜ë¦¬

3. **ê´€ë¦¬ì ì„¤ì • í˜ì´ì§€**
   - ê³µìš© ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ UI
   - ë©”ì¼ ìˆ˜ì‹ ì ê´€ë¦¬ UI
   - ê´€ë¦¬ì ê¶Œí•œ ê²€ì¦

4. **ê´€ë¦¬ì API**
   - ë¹„ë°€ë²ˆí˜¸ ì—…ë°ì´íŠ¸ API
   - ë¹„ë°€ë²ˆí˜¸ ì´ë ¥ ê¸°ë¡ API
   - ë©”ì¼ ìˆ˜ì‹ ì CRUD API

### â³ ë‹¤ìŒ êµ¬í˜„ ì˜ˆì •

1. **ë©”ì¼ ë°œì†¡ ê¸°ëŠ¥** (Phase 2)
   - Resend API ì—°ë™
   - ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì•Œë¦¼ ë©”ì¼
   - ë©”ì¼ í…œí”Œë¦¿

2. **ì£¼ê°„ ìë™ ë³€ê²½** (Phase 3)
   - Supabase Edge Function
   - Cron Job ìŠ¤ì¼€ì¤„ë§
   - ëœë¤ ë¹„ë°€ë²ˆí˜¸ ìƒì„±

3. **ì ‘ì† ë¡œê·¸ ê¸°ë¡** (Phase 4)
   - ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ ê¸°ë¡
   - í™œë™ ì¶”ì 
   - í†µê³„ ëŒ€ì‹œë³´ë“œ

---

**ì‘ì„±ì**: Claude
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-11-07 16:00 KST
**ë²„ì „**: v1.0
